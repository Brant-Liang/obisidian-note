
## 密码学的发展简史

```
我画蓝江水悠悠，
爱晚亭上枫叶愁。
秋月溶溶照佛寺，
香烟袅袅绕经楼。
```
- 表达的意义：我爱秋香

1. ### 滚桶密码
    - 滚筒的尺寸来设计，只有尺寸大小一摸一样的滚筒才能解密文字
### 近代密码学

密码形成一门新的学科是在20世纪70年代，这是受计算机科学蓬勃发展刺激和推动的结果。快速电子计算机和现代数学方法一方面为加密技术提供了新的概念和工具，另一方面也给破译者提供了有力武器。计算机和电子学时代的到来给密码设计者带来了前所未有的自由，他们可以轻易地摆脱原先用铅笔和纸进行手工设计时易犯的错误，也不用再面对用电子机械方式实现的密码机的高额费用。

  
Arthur Scherbius于1919年设计出了历史上最著名的密码机—德国的Enigma机,，在二次世界大战期间， Enigma曾作为德国陆、海、空三军最高级密码机。Enigma机使用了3个正规轮和1个反射轮。这使得英军从1942年2月到12月都没能解读出德国潜艇发出的信号。转轮密码机的使用大大提高了密码加密速度，但由于密钥量有限，到二战中后期时，引出了一场关于加密与破译的对抗。首先是波兰人利用德军电报中前几个字母的重复出现，破解了早期的Enigma密码机，而后又将破译的方法告诉了法国人和英国人。英国人在计算机理论之父——图灵的带领下，通过寻找德国人在密钥选择上的失误，并成功夺取德军的部分密码本，获得密钥，以及进行选择明文攻击等等手段，破解出相当多非常重要的德军情报。

  
这一阶段真正开始源于香农在20世纪40年代末发表的一系列论文，特别是1949年的《保密系统通信理论》，把已有数千年历史的密码学推向了基于信息论的科学轨道。近 代密码发展中一个重要突破是“数据加密标准”（DES）的出现。DES 密码的意义在于，首先，其出现使密码学得以从政府走向民间，其设计主要由IBM公司完成，国家安全局等政府部门只是参与其中，最终经美国国家标准局公开征集遴选后，确定为联邦信息处理标准。其次，DES密码设计中的很多思想（Feistel结构、S盒等），被后来大多数分组密码所采用。再次，DES 出现之后，不仅在美国联邦部门中使用，而且风行世界，并在金融等商业领域广泛使用。

DES: 近代密码学的形成
- 单密钥加密
	- 只有一把钥匙
	- 加密解密都是用这把密钥
### 现代密码学
1976 年，美国密码学家提出“公钥密码”概念。此类密码中加密和解密使用不同的密钥，其中，用于加密的叫做公钥，用于解密的为私钥。1977年，美国麻省理工学院提出第一个公钥加密算法 RSA 算法，之后 ElGamal、椭圆曲线、双线性对等公钥密码相继被提出，密码学真正进入了一个新的发展时期。一般来说，公钥密码的安全性由相应数学问题在计算机上的难解性来保证，以广为使用的RSA算法为例，它的安全性是建立在大整数素因子分解在计算机上的困难性，如，对于整数22，我们易于发现它可以分解为2和11两个素数相乘，但对于一个500位的整数，即使采用相应算法，也要很长时间才能完成分解。但随着计算能力的不断增强和因子分解算法的不断改进，

- RSA 算法出现，标志着现代密码学走向成熟
- 公钥密码： 双密钥，一把公，一把私
	- 加解密
		- 公加密私钥解密
	- 签名验证
		- 私钥签名
		- 公钥验证签名

### 量子密码学

特别是量子计算机的发展，公钥密码安全性也渐渐受到威胁， 抗量子计算密码学研究也很火热

目前，研究者们开始关注量子密码、格密码等抗量子算法的密码，后量子密码等前沿密码技术逐步成为研究热点。

但是目前是不成熟的，逐步走向成熟中。

### 单向散列函数

- Hash 碰撞：给定一个 X，得到 H(X), 给定一个 Y 也能得到 H(X), 碰撞的可能性极低，在现有计算机体系，即使地球爆炸，也很难发生碰撞

- Hash 算法攻击：穷举，不断找 X，直到得得 H(X') = H(X)
- 特点
    
    - 单向不可逆性
        
    - 进行防篡改
        
    - Hash 碰撞
        
- 攻击方式：穷举
    
- Hash 算法：
    
    - MD4和 MD5: 已经被破解
        
    - Sha-0 和 Sha-1: 已经被破解
        
    - 破解的事件
        
        - 2004年8月17日，在CRYPTO 2004的Rump会议上，王小云，冯登国、来学嘉，和于红波宣布了攻击MD5、SHA-0 和其他杂凑函数的初步结果。他们攻击SHA-0的计算复杂度是2的40次方，这意味着他们的攻击成果比Joux还有其他人所做的更好。请参见MD5 安全性。2005年二月，王小云和殷益群、于红波再度发表了对SHA-0破密的算法，可在2的39次方的计算复杂度内就找到碰撞。
            
        - 2005年二月，王小云、殷益群及于红波发表了对完整版 SHA-1 的攻击，只需少于 2 的 69 次方的计算复杂度，就能找到一组碰撞。（利用生日攻击法找到碰撞需要 2 的 80 次方的计算复杂度。）
            
    - SHA-2：目前还是安全的
        
        - SHA-256 算法
            
        - SHA3-384：384位输出长度
            
        - SHA3-512：512位输出长度
            
    - Keccak 海绵算法：目前是安全
        
    - Blake 和 Blake2：目前是安全
        
    - Poseidon 算法：应用在 ZK 承诺里面，安全级别很高，目前是没有被破解
        
- Hash 算法的应用场景
    
    - 做为数字信封，防止被篡改
        
    - 生成数字摘要，用于辅助数字签名

### 三. 对称加密

- 单密钥加密
    
    - 只有一把密码
        
    - 加密解密都是使用这把密钥
        
- 代表算法
    
    - DES：已经被破解，不安全
        
    - 3DES：安全的，复杂度很高，算法效率
        
    - AES: 相对于 3DES 复杂度低很多，效率要高很多，还是安全的


### 四.非对称加密(公钥密码学)

- 公钥密码：双密钥，一般公钥，一把是私钥，公钥匙一般是公开的，私钥是持有私有的
    
    - 加解密
        
        - 公钥用于加密
            
        - 私钥用于解密
            
    - 签名验签
        
        - 私钥签名
            
        - 公钥验证签名
            
- 代表算法
    
    - RSA 算法流程
```Go
密钥生成
选择两个大素数: 选择两个大素数 p 和 𝑞。
计算模数 𝑛
𝑛=𝑝×𝑞 
计算欧拉函数 𝜙(𝑛)
𝜙(𝑛)=(𝑝−1)×(𝑞−1)
选择公钥指数 𝑒
选择一个整数 𝑒 满足 1<𝑒<𝜙(𝑛)  且 𝑒与 𝜙(𝑛) 互质。
计算私钥指数 𝑑
计算 𝑑使得 𝑑×𝑒≡1 mod  𝜙(𝑛)，即 𝑑 是 𝑒 在模 𝜙(𝑛) 下的乘法逆元。
公钥和私钥
公钥：(𝑒,𝑛)
私钥：(𝑑,𝑛)
加密过程
假设明文为 𝑀，加密得到密文 𝐶 的过程如下：
解密过程
假设密文为 𝐶，解密得到明文 𝑀 的过程如下：
签名和验证
数字签名: 用私钥对消息 𝑀 进行签名，得到签名 𝑆：
验证签名: 用公钥验证签名 𝑆，验证得到消息 𝑀′：
如果 𝑀′=𝑀，则签名验证通过。
```

- #### 椭圆曲线算法 ECC，ECDSA 和 EDDSA（重要）
    
    - ECDSA：安全性依赖椭圆曲线的离散对数问题
        
        - secp256k1 256bit 比特币，以太坊
            
        - secp256r1 256bit EOS 用到了
            
        - secp384r1
            
        - secp512r1
            
    - EDDSA：EdWards 曲线
        
        - ed25519 256bit Solana, Ton
            
        - ed448 448bit 更高的安全需求
            
    - ECDSA Vs EDDSA 对比
        
        - 曲线上：ECDSA weierstrass 曲线，EDDSA EdWards 曲线
            
        - ECDSA 依赖随机数; EDDSA不依赖随机数, 通过 H(d)
            
        - ECDSA 更容易被攻击，EDDSA 更安全
            
        - 签名速度：ECDSA 慢，EDDSA 快
            
        - 验证签名：ECDSA 慢，EDDSA 快
            
        - 举例子
            
            - ECDSA：BTC， ETH
                
            - EdDSA：Solana, Sui, Aptos, Ton
### 五、门限共享秘密 (Threshold Secret Sharing)

  门限共享秘密，秘密的备份和恢复，在密钥托管项目里面应用是比较广泛的，门限共享秘密算法（Threshold Secret Sharing）是一种密码学技术，用于将一个秘密（比如一个密钥或重要信息）分割成多个部分（称为“份额”），并分发给不同的参与者，只有当一定数量的份额（达到或超过预设的“门限”）集合在一起时，才能重建原始秘密。这种方法可以增强安全性，防止单一参与者掌握全部秘密，同时也能在部分参与者不可用时仍能恢复秘密。
##### 1. 直接用门限共享秘密算法
	
![[Pasted image 20250227004444.png]]
#### #2.云端可干扰抗秘密丢失解决方案
![[Pasted image 20250227005431.png]]
### 六、MPC 算法

安全多方计算：

- 多方参与，进行多轮交互计算出各自密钥分片，参与方之间互相不知道对方的密钥碎片，所有节点持有密钥分片可以组成一把完整的私钥，MPC 也是一种门限签名
![[Pasted image 20250227172313.png]]